server {
    listen 80; # Or 443 for HTTPS
    server_name your-domain.com; # Replace with your domain, e.g., localhost or example.com

    # Proxy API requests to the backend
    location /api/ {
        proxy_pass http://localhost:8700; # Backend port
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # Proxy requests for served static pages to the backend
    location /p/ {
        proxy_pass http://localhost:8700; # Backend port
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # Serve frontend static files (after npm run build)
    # IMPORTANT: Replace /path/to/web-hosting-service/frontend/dist with the actual absolute path
    # where your frontend's 'dist' directory is located after running 'npm run build'.
    # Example: /Users/lewis.chan/Documents/workspaceAI/WebShareeee/web-hosting-service/frontend/dist
    location / {
        root /path/to/web-hosting-service/frontend/dist; # <--- REPLACE THIS PATH
        try_files $uri $uri/ /index.html; # For Vue Router history mode
    }
}
